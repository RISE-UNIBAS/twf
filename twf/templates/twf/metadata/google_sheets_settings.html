{% extends 'twf/base/base.html' %}
{% load crispy_forms_tags %}

{% block content %}
    <p class="lead">Configure connection to Google Sheets for metadata import.</p>

    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        {% crispy form %}
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="alert alert-info">
                    <h5><i class="fas fa-info-circle"></i> Configuration Guide</h5>

                    <p><strong>Google Sheet ID:</strong> The unique identifier from your Google Sheets URL.</p>
                    <p class="ms-3">
                        From URL: <code>https://docs.google.com/spreadsheets/d/<mark>1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms</mark>/edit</code><br/>
                        Copy: <code>1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms</code>
                    </p>

                    <p><strong>Sheet Range:</strong> The range of cells to import in A1 notation.</p>
                    <p class="ms-3">
                        Examples:
                    </p>
                    <ul class="ms-3">
                        <li><code>A1:D100</code> - Columns A through D, rows 1 through 100</li>
                        <li><code>Sheet1!A1:D100</code> - Same range from a specific sheet</li>
                        <li><code>Metadata!A:D</code> - All rows in columns A through D from "Metadata" sheet</li>
                    </ul>

                    <p><strong>Valid Columns:</strong> Comma-separated list of column names that should be imported.</p>
                    <p class="ms-3">
                        Example: <code>author,title,date,location</code>
                    </p>

                    <p><strong>Document ID Column:</strong> The column name that contains the document ID to match with documents in your project.</p>
                    <p class="ms-3">
                        Example: <code>document_id</code> or <code>tk_doc_id</code>
                    </p>

                    <p><strong>Document Title Column:</strong> The column name that contains the document title.</p>
                    <p class="ms-3">
                        Example: <code>title</code> or <code>document_name</code>
                    </p>

                    <hr class="my-4">

                    <h6>Prerequisites</h6>
                    <ol>
                        <li>Share your Google Sheet with the service account email</li>
                        <li>Ensure the sheet has a header row with column names</li>
                        <li>Configure Google Sheets credentials in Project Settings → Credentials</li>
                    </ol>

                    <h6 class="mt-3">Usage</h6>
                    <p>After configuration, use <strong>Metadata → Load Metadata → Load Google Sheets Metadata</strong> to import data.</p>
                </div>
            </div>
        </div>
    </div>
{% endblock %}